(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{117:function(e,t,a){},121:function(e,t,a){},122:function(e,t,a){},123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),i=a(9),r=a.n(i),l=(a(57),a(5)),s=a(19),o=a(46),u=a(6),m=a(17),g=a(47),d=a.n(g),p="http://localhost:8000";switch(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_ENV){case"local":p="http://localhost:8000";break;case"prod":p="//tiles.trafimage.ch"}var f={baseUrl:p},h="SET_IMAGES",v="SET_PAGES",b="SET_TAG_SUGGESTIONS",E="ADD_IMAGE",j={images:[],pages:[],tagSuggestions:[]};var O=Object(s.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(m.a)({},e,{images:Object(u.a)(t.data)});case v:return Object(m.a)({},e,{pages:Object(u.a)(t.data)});case b:return Object(m.a)({},e,{tagSuggestions:Object(u.a)(t.data)});case E:return Object(m.a)({},e,{images:[].concat(Object(u.a)(e.images),[t.data])});default:return Object(m.a)({},e)}},Object(s.a)(o.a)),N=a(12),y=a(13),I=a(15),S=a(14),k=a(16),w=a(24),T=a(10),D=a(48),C=(a(62),function(e){var t=e.icon,a=e.exact,n=e.title,i=e.link,r=D[t];return c.a.createElement("div",{className:"HeaderLink"},c.a.createElement(w.b,{exact:a,to:i?"/".concat(i):"/"},c.a.createElement(r,{title:n})))});C.defaultProps={icon:null,link:null,exact:!1};var F=C,U=(a(68),Object(l.b)(function(e){return{pages:e.pages}},{})(function(e){var t=e.pages;return c.a.createElement("div",{className:"Header"},c.a.createElement("div",{className:"inner"},c.a.createElement("h1",null,"Climage"),c.a.createElement("div",{className:"links"},c.a.createElement(F,{title:"Gallery",icon:"FiImage",exact:!0}),c.a.createElement(F,{title:"Upload",link:"upload",icon:"FiUploadCloud"}),t.map(function(e){return c.a.createElement(F,{key:e.slug,title:e.title,icon:e.icon,link:e.slug})}))))})),A=(a(69),function(e){var t=e.page;return c.a.createElement("div",{className:"PageContent"},c.a.createElement("div",{className:"page-title"},t.title),c.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.content}}))}),P=a(50),_=a.n(P),x=(a(117),function(e){function t(e){var a;return Object(N.a)(this,t),(0,(a=Object(I.a)(this,Object(S.a)(t).call(this,e))).props.dispatchFetchImages)(),a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props,t=e.images,a=e.dispatchFetchImages;return c.a.createElement("div",{className:"Gallery"},c.a.createElement("input",{className:"image-search",type:"text",placeholder:"Search...",onChange:function(e){(!e.target.value||e.target.value.length>2)&&a(e.target.value)}}),c.a.createElement(_.a,{margin:5,images:t,enableImageSelection:!1,showImageCount:!1}))}}]),t}(n.Component)),G={dispatchFetchImages:function(e){return function(t){var a="".concat(f.baseUrl,"/core/image/");a+=e?"?search=".concat(e):"",fetch(a).then(function(e){return e.json()}).then(function(e){t({type:h,data:e})})}}},R=Object(l.b)(function(e){return{images:e.images}},G)(x),L=a(29),H=a(51),B=a.n(H),M=(a(121),function(e){var t=e.title,a=e.description,n=e.image,i=e.sidebar;return c.a.createElement("div",{className:"ImagePage"},c.a.createElement("div",{className:"content"},c.a.createElement("div",{className:"field"},t),c.a.createElement("div",{className:"image"},n),c.a.createElement("div",{className:"field"},a)),c.a.createElement("div",{className:"sidebar"},i))});M.defaultProps={title:null,description:null,image:null,sidebar:null};var J=M,V=(a(122),function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(I.a)(this,Object(S.a)(t).call(this,e))).state={imageTitle:"",imageDescription:"",imageUrl:null,imageFile:null,tags:[]},a.fileInput=null,a.fileReader=new FileReader,a.fileReader.addEventListener("load",function(){a.setState({imageUrl:a.fileReader.result})}),a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"onDrop",value:function(e){e.preventDefault();var t=["image/png","image/jpeg"];if(e.dataTransfer.items)for(var a=0;a<e.dataTransfer.items.length;a+=1)if(t.includes(e.dataTransfer.items[a].type)){var n=e.dataTransfer.items[a].getAsFile();this.loadImage(n)}}},{key:"loadImage",value:function(e){this.fileReader.readAsDataURL(e),this.setState({imageFile:e})}},{key:"submitData",value:function(){var e=this.props.dispatchAddImage,t=this.state;e({tags:t.tags,caption:t.imageTitle,description:t.imageDescription,src:t.imageFile})}},{key:"render",value:function(){var e=this,t=this.state,a=t.imageUrl,n=t.imageTitle,i=t.imageDescription,r=t.tags,l=this.props,s=l.tagSuggestions,o=l.dispatchFetchTags,m=c.a.createElement(L.b,{className:"icon"});a&&(m=c.a.createElement("img",{className:"image",src:a,alt:"Preview"}));var g=c.a.createElement("input",{className:"input-field image-title",placeholder:"Enter title",value:n,onChange:function(t){return e.setState({imageTitle:t.target.value})}}),d=c.a.createElement("textarea",{className:"input-field image-description",placeholder:"Add description",value:i,onChange:function(t){return e.setState({imageDescription:t.target.value})}}),p=c.a.createElement("div",{className:"input-sidebar"},c.a.createElement("div",{className:"tags"},c.a.createElement(B.a,{allowNew:!0,tags:r,suggestions:s,handleAddition:function(t){return e.setState({tags:[].concat(Object(u.a)(r),[t])})},handleInputChange:function(e){return o(e)},handleDelete:function(t){var a=Object(u.a)(r);a.splice(t,1),e.setState({tags:a})}})),c.a.createElement("button",{className:"submit-button",type:"submit",disabled:!(a&&n&&i),onClick:function(){return e.submitData()}},c.a.createElement(L.a,null),"\xa0Upload image")),f=c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{type:"file",onChange:function(t){t.target.files.length&&e.loadImage(t.target.files[0])},ref:function(t){e.fileInput=t},style:{display:"none"}}),c.a.createElement("div",{className:"image-upload",onDragOver:function(e){return e.preventDefault()},onDrop:function(t){return e.onDrop(t)},onClick:function(){return e.fileInput.click()},onKeyPress:function(t){return 13===t.which&&e.fileInput.click()},role:"button",tabIndex:"0"},m));return c.a.createElement(J,{title:g,image:f,description:d,sidebar:p})}}]),t}(n.Component)),W={dispatchAddImage:function(e){return function(t){var a=d()(e);fetch("".concat(f.baseUrl,"/core/image/"),{method:"POST",body:a}).then(function(e){return e.json()}).then(function(e){t({type:E,data:e})})}},dispatchFetchTags:function(e){return function(t){var a="".concat(f.baseUrl,"/core/tag/");a+=e?"?search=".concat(e):"",fetch(a).then(function(e){return e.json()}).then(function(e){t({type:b,data:e})})}}},K=Object(l.b)(function(e){return{tagSuggestions:e.tagSuggestions}},W)(V),$=(a(123),function(e){function t(e){var a;return Object(N.a)(this,t),(0,(a=Object(I.a)(this,Object(S.a)(t).call(this,e))).props.dispatchFetchPages)(),a}return Object(k.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props.pages;return c.a.createElement("div",{className:"Home"},c.a.createElement(w.a,null,c.a.createElement(U,null),c.a.createElement("div",{className:"body"},c.a.createElement(T.a,{exact:!0,path:"/",component:R}),c.a.createElement(T.a,{exact:!0,path:"/upload/",component:K}),e.map(function(e){return c.a.createElement(T.a,{path:"/".concat(e.slug,"/"),render:function(){return c.a.createElement(A,{page:e})}})}))))}}]),t}(n.Component));$.defaultProps={pages:[]};var q={dispatchFetchPages:function(){return function(e){fetch("".concat(f.baseUrl,"/core/page/")).then(function(e){return e.json()}).then(function(t){e({type:v,data:t})})}}},z=Object(l.b)(function(e){return{pages:e.pages}},q)($);a(124),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(c.a.createElement(function(){return c.a.createElement("div",{className:"App"},c.a.createElement(l.a,{store:O},c.a.createElement(z,null)))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},52:function(e,t,a){e.exports=a(125)},57:function(e,t,a){},62:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){}},[[52,1,2]]]);
//# sourceMappingURL=main.cdbe2e58.chunk.js.map