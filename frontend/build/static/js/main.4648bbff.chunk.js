(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{117:function(e,t,a){},121:function(e,t,a){},122:function(e,t,a){},123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),c=a(9),r=a.n(c),l=(a(57),a(5)),s=a(20),o=a(46),u=a(6),m=a(11),g=a(47),d=a.n(g),p={backendUrl:"//backend.climage.mariohaertwig.de"},f="SET_IMAGES",h="SET_PAGES",v="SET_TAG_SUGGESTIONS",b="ADD_IMAGE",E="IMAGE_UPLOADING",j={images:[],pages:[],tagSuggestions:[],isImageUploading:!1};var O=Object(s.c)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return Object(m.a)({},e,{isImageUploading:t.data});case f:return Object(m.a)({},e,{images:Object(u.a)(t.data)});case h:return Object(m.a)({},e,{pages:Object(u.a)(t.data)});case v:return Object(m.a)({},e,{tagSuggestions:Object(u.a)(t.data)});case b:return Object(m.a)({},e,{images:[].concat(Object(u.a)(e.images),[t.data])});default:return Object(m.a)({},e)}},Object(s.a)(o.a)),I=a(13),y=a(14),N=a(17),k=a(15),U=a(18),S=a(16),w=a(10),D=a(21),T=a(48),F=(a(62),function(e){var t=e.icon,a=e.exact,n=e.title,c=e.link,r=T[t];return i.a.createElement("div",{className:"HeaderLink"},i.a.createElement(S.b,{exact:a,to:c?"/".concat(c):"/"},i.a.createElement(r,{title:n})))});F.defaultProps={icon:null,link:null,exact:!1};var A=F,C=(a(68),Object(l.b)(function(e){return{isImageUploading:e.isImageUploading,pages:e.pages}},{})(function(e){var t=e.pages,a=e.isImageUploading;return i.a.createElement("div",{className:"Header"},i.a.createElement("div",{className:"inner"},i.a.createElement("div",{className:"header-title"},i.a.createElement(S.b,{to:"/"},i.a.createElement("h1",null,"Climage"),a?i.a.createElement(D.c,{className:"icon-spin"}):null)),i.a.createElement("div",{className:"links"},i.a.createElement(A,{title:"Gallery",icon:"FiImage",exact:!0}),i.a.createElement(A,{title:"Upload",link:"upload",icon:"FiUploadCloud"}),t.map(function(e){return i.a.createElement(A,{key:e.slug,title:e.title,icon:e.icon,link:e.slug})}))))})),P=(a(69),function(e){var t=e.page;return i.a.createElement("div",{className:"PageContent"},i.a.createElement("div",{className:"page-title"},t.title),i.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.content}}))}),x=a(50),G=a.n(x),_=(a(117),function(e){function t(e){var a;return Object(I.a)(this,t),(0,(a=Object(N.a)(this,Object(k.a)(t).call(this,e))).props.dispatchFetchImages)(),a}return Object(U.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props,t=e.images,a=e.dispatchFetchImages;return i.a.createElement("div",{className:"Gallery"},i.a.createElement("input",{className:"image-search",type:"text",placeholder:"Search...",onChange:function(e){(!e.target.value||e.target.value.length>2)&&a(e.target.value)}}),i.a.createElement(G.a,{margin:5,images:t,enableImageSelection:!1,showImageCount:!1}))}}]),t}(n.Component)),R={dispatchFetchImages:function(e){return function(t){var a="".concat(p.backendUrl,"/core/image/");a+=e?"?search=".concat(e):"",fetch(a).then(function(e){return e.json()}).then(function(e){t({type:f,data:e})})}}},L=Object(l.b)(function(e){return{images:e.images}},R)(_),H=a(51),M=a.n(H),B=(a(121),function(e){var t=e.title,a=e.description,n=e.image,c=e.sidebar;return i.a.createElement("div",{className:"ImagePage"},i.a.createElement("div",{className:"content"},i.a.createElement("div",{className:"field"},t),i.a.createElement("div",{className:"image"},n),i.a.createElement("div",{className:"field"},a)),i.a.createElement("div",{className:"sidebar"},c))});B.defaultProps={title:null,description:null,image:null,sidebar:null};var J=B,W=(a(122),function(e){function t(e){var a;return Object(I.a)(this,t),(a=Object(N.a)(this,Object(k.a)(t).call(this,e))).state={imageTitle:"",imageDescription:"",imageUrl:null,imageFile:null,tags:[]},a.fileInput=null,a.fileReader=new FileReader,a.fileReader.addEventListener("load",function(){a.setState({imageUrl:a.fileReader.result})}),a}return Object(U.a)(t,e),Object(y.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.isImageUploading,n=t.history;!a&&e.isImageUploading&&n.push("/")}},{key:"onDrop",value:function(e){e.preventDefault();var t=["image/png","image/jpeg"];if(e.dataTransfer.items)for(var a=0;a<e.dataTransfer.items.length;a+=1)if(t.includes(e.dataTransfer.items[a].type)){var n=e.dataTransfer.items[a].getAsFile();this.loadImage(n)}}},{key:"loadImage",value:function(e){this.fileReader.readAsDataURL(e),this.setState({imageFile:e})}},{key:"submitData",value:function(){var e=this.props.dispatchAddImage,t=this.state;e({tags:t.tags,caption:t.imageTitle,description:t.imageDescription,src:t.imageFile})}},{key:"render",value:function(){var e=this,t=this.state,a=t.imageUrl,n=t.imageTitle,c=t.imageDescription,r=t.tags,l=this.props,s=l.tagSuggestions,o=l.dispatchFetchTags,m=i.a.createElement(D.b,{className:"icon"});a&&(m=i.a.createElement("img",{className:"image",src:a,alt:"Preview"}));var g=i.a.createElement("input",{className:"input-field image-title",placeholder:"Enter title",value:n,onChange:function(t){return e.setState({imageTitle:t.target.value})}}),d=i.a.createElement("textarea",{className:"input-field image-description",placeholder:"Add description",value:c,onChange:function(t){return e.setState({imageDescription:t.target.value})}}),p=i.a.createElement("div",{className:"input-sidebar"},i.a.createElement("div",{className:"tags"},i.a.createElement(M.a,{allowNew:!0,tags:r,suggestions:s,handleAddition:function(t){return e.setState({tags:[].concat(Object(u.a)(r),[t])})},handleInputChange:function(e){return o(e)},handleDelete:function(t){var a=Object(u.a)(r);a.splice(t,1),e.setState({tags:a})}})),i.a.createElement("button",{className:"submit-button",type:"submit",disabled:!(a&&n&&c),onClick:function(){return e.submitData()}},i.a.createElement(D.a,null),"\xa0Upload image")),f=i.a.createElement(i.a.Fragment,null,i.a.createElement("input",{type:"file",onChange:function(t){t.target.files.length&&e.loadImage(t.target.files[0])},ref:function(t){e.fileInput=t},style:{display:"none"}}),i.a.createElement("div",{className:"image-upload",onDragOver:function(e){return e.preventDefault()},onDrop:function(t){return e.onDrop(t)},onClick:function(){return e.fileInput.click()},onKeyPress:function(t){return 13===t.which&&e.fileInput.click()},role:"button",tabIndex:"0"},m));return i.a.createElement(J,{title:g,image:f,description:d,sidebar:p})}}]),t}(n.Component)),K={dispatchAddImage:function(e){return function(t){var a=d()(e);t({type:E,data:!0}),fetch("".concat(p.backendUrl,"/core/image/"),{method:"POST",body:a}).then(function(e){return e.json()}).then(function(e){t({type:b,data:e}),t({type:E,data:!1})})}},dispatchFetchTags:function(e){return function(t){var a="".concat(p.backendUrl,"/core/tag/");a+=e?"?search=".concat(e):"",fetch(a).then(function(e){return e.json()}).then(function(e){t({type:v,data:e})})}}},$=Object(l.b)(function(e){return{isImageUploading:e.isImageUploading,tagSuggestions:e.tagSuggestions}},K)(W),q=(a(123),function(e){function t(e){var a;return Object(I.a)(this,t),(0,(a=Object(N.a)(this,Object(k.a)(t).call(this,e))).props.dispatchFetchPages)(),a}return Object(U.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props.pages;return i.a.createElement("div",{className:"Home"},i.a.createElement(S.a,null,i.a.createElement(C,null),i.a.createElement("div",{className:"body"},i.a.createElement(w.a,{exact:!0,path:"/",component:L}),i.a.createElement(w.a,{exact:!0,path:"/upload/",component:$}),e.map(function(e){return i.a.createElement(w.a,{path:"/".concat(e.slug,"/"),render:function(){return i.a.createElement(P,{page:e})}})}))))}}]),t}(n.Component));q.defaultProps={pages:[]};var z={dispatchFetchPages:function(){return function(e){fetch("".concat(p.backendUrl,"/core/page/")).then(function(e){return e.json()}).then(function(t){e({type:h,data:t})})}}},Q=Object(l.b)(function(e){return{pages:e.pages}},z)(q);a(124),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(function(){return i.a.createElement("div",{className:"App"},i.a.createElement(l.a,{store:O},i.a.createElement(Q,null)))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},52:function(e,t,a){e.exports=a(125)},57:function(e,t,a){},62:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){}},[[52,1,2]]]);
//# sourceMappingURL=main.4648bbff.chunk.js.map